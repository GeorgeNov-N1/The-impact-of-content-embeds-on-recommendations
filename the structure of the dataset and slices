# Как устроен датасет VK-LSVD

**VK-LSVD** — это лог показов коротких видео. Каждая строка в `interactions` соответствует **одному показу одного видео одному пользователю**, включая реакцию пользователя на этот показ.

---

## Основные сущности

- **user_id** — пользователь (анонимизированный)
- **item_id** — видеоролик (анонимизированный)

---

## Взаимодействия (interactions)

Для каждого показа фиксируются:

- **Неявные сигналы:**  
  `timespent` (`uint8`) — сколько секунд пользователь смотрел видео (главный implicit-сигнал)

- **Явные действия:**  
  `like`, `dislike`, `share`, `bookmark`, `click_on_author`, `open_comments` (булевы значения)

- **Контекст показа:**  
  `place`, `platform`, `agent` (в базовых моделях обычно игнорируется)

---

## Важные особенности

- Каждая пара `(user_id, item_id)` встречается **ровно один раз**  
- Данные **не сессионные** — одна сессия может быть представлена множеством строк

---

## Временная структура

- Явного `timestamp` может не быть  
- Время задаётся порядком строк и файлов:  
  `week_00 → week_01 → … → week_24 (train) → week_25 (validation)`  
- События разных пользователей перемешаны, лог идёт в глобальном времени

---

## Train / Validation

- **Train** — прошлые недели, на них обучаем модель  
- **Validation** — следующая неделя (будущее), используется для честной оценки

---

## Метаданные

- **users_metadata:** age, gender, geo, activity_rank  
- **items_metadata:** author_id, duration, popularity_rank  
- **item_embeddings:** контентные эмбеддинги роликов (64 компоненты, можно использовать первые n)

---

## Подвыборки

Примеры:

- `up0.001` — 0.1% пользователей  
- `ip0.001` — 0.1% популярных айтемов по `train_interactions_rank`  

При этом сохраняется временное разбиение: 25 недель train + 1 неделя validation

---

## Формирование срезов

**Обозначения ur / up / ir / ip:**

- **Пользователи:**  
  - `urX` — случайные пользователи, X = доля, например `ur0.01` → 1% пользователей  
  - `upX` — популярные пользователи, X = доля самых активных, отбор по `train_interactions_rank`

- **Айтемы:**  
  - `irX` — случайные айтемы  
  - `ipX` — популярные айтемы, отбор по `train_interactions_rank`

---

## train_interactions_rank

Ключевая переменная — ранг по числу взаимодействий в train:

- `rank = 1` → самый популярный / активный  
- Чем больше число → тем менее популярный объект

Применение:

- Для пользователей — определяет активность  
- Для айтемов — определяет популярность

Преимущества precomputed поля:

- Не нужно пересчитывать популярность каждый раз  
- Позволяет делать честные срезы данных по активности и популярности
